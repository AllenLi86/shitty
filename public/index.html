<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <!-- 🔥 重要：這個 meta 標籤告訴手機如何正確縮放頁面 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  <!-- 🔥 其他手機優化 meta 標籤 -->
  <meta name="format-detection" content="telephone=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#667eea">
  
  <title>瞎掰王 - 雙人遊戲</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>👑 瞎掰王（雙人同步遊戲）v1.1.1</h1>

    <div id="login">
      <div class="login-section">
        <div class="player-login" id="playerA-section">
          <h3>玩家 A</h3>
          <input type="text" id="playerA-name" placeholder="玩家A的名字" />
          <br>
          <button onclick="joinAsPlayer('A')">加入為玩家A</button>
          <div id="playerA-status"></div>
        </div>
        
        <div class="player-login" id="playerB-section">
          <h3>玩家 B</h3>
          <input type="text" id="playerB-name" placeholder="玩家B的名字" />
          <br>
          <button onclick="joinAsPlayer('B')">加入為玩家B</button>
          <div id="playerB-status"></div>
        </div>
      </div>

      <!-- 🔥 新增：遊戲設定區域 -->
      <div class="game-settings">
        <h3>⚙️ 遊戲設定</h3>
        <div class="settings-row">
          <div class="setting-group">
            <label for="timer-seconds">⏰ 計時秒數：</label>
            <input type="number" id="timer-seconds" min="0" max="300" value="15" placeholder="0表示不計時" oninput="validateTimerInput(this)">
          </div>
          
          <div class="setting-group">
            <label for="timer-effect">💡 老實人計時結束效果：</label>
            <select id="timer-effect">
              <option value="hide" selected>隱藏解答</option>
              <option value="dim">解答變淡</option>
            </select>
          </div>
        </div>
        
        <div class="settings-hint">
          <div>💡 提示：</div>
          <div>• <strong>計時秒數</strong>：輸入0表示不計時，其他數字為倒數時間（最大300秒）</div>
          <div>• <strong>隱藏解答</strong>：時間到後老實人的解答區會完全隐藏</div>
          <div>• <strong>解答變淡</strong>：時間到後解答區會變灰變淡，但仍可勉強看到</div>
        </div>
      </div>
      
      <div style="text-align: center;">
        <button id="startGame" onclick="startGame()" disabled>開始遊戲</button>
      </div>
    </div>

    <div id="game-area" class="game-area">
      <!-- 分數顯示區域 -->
      <div id="score-display" class="score-display"></div>

      <!-- 🔥 新增：計時器顯示 -->
      <div id="timer-display" class="timer-display" style="display: none;">
        <div class="timer-circle">
          <div class="timer-text">
            <div class="timer-number" id="timer-number">15</div>
            <div class="timer-label">秒</div>
          </div>
          <svg class="timer-ring" width="100" height="100">
            <circle id="timer-circle" cx="50" cy="50" r="42" stroke="#ff6b6b" stroke-width="6" fill="none" />
          </svg>
        </div>
      </div>

      <!-- 想想模式UI -->
      <div id="guesser-ui" class="role-ui guesser-mode" style="display: none;">
        <div class="role-badge guesser-badge">🤔 你是想想</div>
        <div class="instruction">觀察對方的回答，猜測他是老實人還是瞎掰人！</div>
        <div id="guesser-question" class="question"></div>
        <div id="guesser-buttons" class="buttons">
          <button class="guess-button honest" onclick="makeGuess('honest')">🙋‍♂️ 他是老實人</button>
          <button class="guess-button liar" onclick="makeGuess('liar')">🤥 他是瞎掰人</button>
        </div>
      </div>

      <!-- 答題者模式UI -->
      <div id="answerer-ui" class="role-ui answerer-mode" style="display: none;">
        <div id="answerer-role-badge" class="role-badge"></div>
        <div id="answerer-instruction" class="instruction"></div>
        <div id="answerer-question" class="question"></div>
        <div id="answerer-explanation" class="explanation" style="display: none;"></div>
        <div class="waiting">等待想想做出猜測...</div>
      </div>

      <!-- 結果顯示 -->
      <div id="result-display" class="result-display" style="display: none;">
        <div id="result-text"></div>
        <div class="result-buttons">
          <button onclick="nextRound()">下一回合</button>
          <button id="end-game-btn" class="end-game-btn" onclick="endGame()" style="display: none;">🏁 結算遊戲</button>
        </div>
      </div>

      <!-- 遊戲結算顯示 -->
      <div id="game-end-display" class="game-end-display" style="display: none;">
        <div id="game-end-text"></div>
        <div class="end-game-buttons">
          <button class="new-game-btn" onclick="newGame()">🎮 開新遊戲</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 遊戲模組 -->
  <script src="config.js"></script>
  <script src="utils.js"></script>
  <script src="questions.js"></script>
  <script src="ui.js"></script>
  <script src="main.js"></script>
  
  <!-- 除錯用：確認函數載入 -->
  <script>
    window.addEventListener('load', () => {
      setTimeout(() => {
        console.log('🔍 檢查函數是否存在:');
        console.log('endGame:', typeof window.endGame);
        console.log('newGame:', typeof window.newGame);
        
        if (typeof window.endGame === 'undefined') {
          console.error('❌ endGame 函數未定義！');
        } else {
          console.log('✅ endGame 函數已正確載入');
        }
      }, 1000);
    });
  </script>
</body>
</html>